{% extends 'base.html' %}

{% block title %}Бодолт харах{% endblock %}

{% block content %}
    <div id="viewer-container" class="my-3" style="width: 100%; min-height: 600px; border: 1px solid #ccc;">
        <ul id="images" class="list-inline d-inline">
            {% for upload in result.upload_set.all %}
                <li class="list-inline-item"><img src="/media/{{ upload.file }}" style="height: 200px"></li>
            {% endfor %}
        </ul></div>
    <button class="btn btn-sm btn-primary" onclick="loadViewer()">Зургийг тодруулж харах</button>
    <button class="btn btn-sm btn-danger" onclick="closeViewer()">Зургийг хаах</button>
<style>
.viewer-container {
    /* !important-г нэмснээр inline style-г дарж бичнэ */
    height: 600px !important;
}
</style>
    <script>
        // Viewer-ийн instance-г хадгалах глобал хувьсагч
        let galleryViewer;

        function loadViewer() {
            if (galleryViewer) {
                return;
            }

            const galleryElement = document.getElementById('images');
            const viewerContainer = document.getElementById('viewer-container'); // Шинэ container-г олох

            galleryViewer = new Viewer(galleryElement, {
                inline: true,
                container: viewerContainer, // <-- Viewer-г харуулах container-г зааж өгөх
                navbar: false, // Доод талын жижиг зургуудыг нуух (заавал биш)
                toolbar: { // Удирдлагын товчлуурууд
                    zoomIn: 1,
                    zoomOut: 1,
                    oneToOne: 1,
                    reset: 1,
                    prev: 1,
                    play: {
                        show: 1,
                        size: 'large',
                    },
                    next: 1,
                    rotateLeft: 1,
                    rotateRight: 1,
                    flipHorizontal: 1,
                    flipVertical: 1,
                },
                viewed() {
                    galleryViewer.zoomTo(0.5);
                },
            });
        }

        function closeViewer() {
            // Хэрэв viewer үүссэн бол устгах
            if (galleryViewer) {
                galleryViewer.destroy();
                galleryViewer = null; // Хувьсагчийг цэвэрлэх
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.11.7/viewer.min.js"
            integrity="sha512-lZD0JiwhtP4UkFD1mc96NiTZ14L7MjyX5Khk8PMxJszXMLvu7kjq1sp4bb0tcL6MY+/4sIuiUxubOqoueHrW4w=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
{% endblock %}