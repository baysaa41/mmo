{% extends 'base.html' %}

{% block content %}
    <div class="container">
        <h2 class="mb-1">{{ olympiad.name }}</h2>
        <p class="lead text-muted">{{ school.name }} | {{ selected_level.name }} ангилал</p>
        <a href="{% url 'school_dashboard' school.id %}" class="btn btn-secondary btn-sm mb-4">&larr; Удирдлагын самбар
            луу буцах</a>
        <hr>

        <!-- Заавар -->
        <div class="card mb-4 border-warning">
            <div class="card-header bg-warning bg-opacity-25" data-bs-toggle="collapse" data-bs-target="#guideCollapse" style="cursor:pointer">
                <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Заавар
                    <i class="fas fa-chevron-down float-end mt-1"></i>
                </h5>
            </div>
            <div id="guideCollapse" class="collapse">
                <div class="card-body">
                    <h6 class="fw-bold">1. Загвар татах</h6>
                    <ol>
                        <li><strong>"Загвар татах"</strong> товч дарж сурагчдын жагсаалт бүхий бөглөхөд бэлэн Excel файлыг татаж авна.</li>
                    </ol>

                    <h6 class="fw-bold mt-3">2. Хариулт оруулах</h6>
                    <ol>
                        <li>Татсан Excel файлын бодлого тус бүрийн баганад оролцогч бүрийн <strong>хариултыг</strong> бичнэ.</li>
                        <li><strong>"Системд хуулах"</strong> товч дарж бөглөсөн Excel файлыг системд оруулна.</li>
                    </ol>

                    <h6 class="fw-bold mt-3">3. Дүн харах</h6>
                    <ul>
                        <li><strong>"Хариулт харах"</strong> — оруулсан хариултуудыг шалгана.</li>
                        <li><strong>"Дүн харах"</strong> — олимпиадын дүнг харна.</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-center">1. Загвар татах</h5>
                        <p class="card-text text-center">Сурагчдын жагсаалт бүхий бөглөхөд бэлэн Excel файлыг татаж
                            авах.</p>
                        <div class="mt-auto text-center">
                            <a href="{% url 'generate_school_answer_sheet' school.id olympiad.id %}"
                               class="btn btn-primary">
                                <i class="fas fa-file-excel"></i> Загвар татах
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% if request.user.is_staff %}
                <div class="col-md-4">
                    <div class="card h-100">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title text-center">2. Дүн хуулах</h5>
                            <p class="text-center">Бөглөсөн Excel файлаа сонгож системд оруулах.</p>
                            <div class="mt-auto">
                                <form action="{% url 'import_school_answer_sheet' school.id olympiad.id %}"
                                      method="post" enctype="multipart/form-data">
                                    {% csrf_token %}
                                    <div class="input-group">
                                        <input type="file" name="file" class="form-control" required>
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-upload"></i> Системд хуулах
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
            <div class="col-md-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-center">2. Хариулт харах</h5>
                        <p class="card-text text-center">Импорт хийсэн олимпиадын дүнг харах.</p>
                        <div class="mt-auto text-center">
                            <a href="{% url 'olympiad_answer_view' olympiad.id %}?s={{ school.id }}"
                               class="btn btn-primary">
                                <i class="fas fa-chart-bar"></i> Хариулт харах
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-center">3. Дүн харах</h5>
                        <p class="card-text text-center">Импорт хийсэн олимпиадын дүнг харах.</p>
                        <div class="mt-auto text-center">
                            <a href="{% url 'view_school_olympiad_results' school.id olympiad.id %}"
                               class="btn btn-primary">
                                <i class="fas fa-chart-bar"></i> Дүн харах
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
{% endblock %}